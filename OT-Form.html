<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Occupational Therapy Followup</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Dialog-specific styles */
    body {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', 'Segoe UI', system-ui, sans-serif;
      background-color: var(--md-surface, #FEFBFF);
      color: var(--md-on-surface, #1B1B1F);
      padding-top: 112px; /* Adjusted for fixed header */
    }
    
    /* Progress steps navigation in secondary action bar */
    .progress-steps-nav {
      display: flex;
      overflow-x: auto;
      white-space: nowrap;
      gap: 8px;
      width: 100%;
      padding: 4px 0;
    }
    
    .progress-step {
      padding: 8px 12px;
      font-size: 14px;
      color: var(--md-on-surface-variant, #44474F);
      position: relative;
      cursor: pointer;
      border-radius: var(--md-shape-corner-small, 4px);
      transition: all 0.2s ease;
    }
    
    .progress-step.active {
      color: var(--md-on-primary-container, #001A41);
      font-weight: 500;
      background-color: var(--md-primary-container, #D8E2FF);
    }
    
    .progress-step.completed::after {
      content: "✓";
      margin-left: 4px;
      color: var(--md-primary, #006CFA);
    }
    
    /* Accordion styles */
    .accordion-section {
      margin-bottom: 16px;
      border: 1px solid var(--md-outline-variant, #C4C6D0);
      border-radius: 8px;
      overflow: hidden;
    }
    
    .accordion-header {
      padding: 16px;
      background-color: var(--md-primary-container, #D8E2FF); /* Changed to blue shade from Material Design 3 */
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
    }
    
    .accordion-title {
      font-size: 16px;
      font-weight: 500;
      margin: 0;
      color: var(--md-on-primary-container, #001A41); /* Changed to appropriate contrast color */
    }
    
    .accordion-content {
      padding: 16px;
      background-color: var(--md-surface, #FEFBFF);
      display: none;
    }
    
    .accordion-content.open {
      display: block;
    }
    
    .accordion-indicator {
      color: var(--md-on-primary-container, #001A41); /* Changed to match title color */
      transition: transform 0.3s ease;
    }
    
    .accordion-indicator.open {
      transform: rotate(180deg);
    }
    
    .accordion-section.completed .accordion-header {
      border-left: 4px solid var(--md-primary, #006CFA);
    }
    
    .accordion-completion-indicator {
      font-size: 14px;
      font-weight: 500;
      color: var(--md-primary, #006CFA);
      margin-right: 12px;
      display: none;
    }
    
    .accordion-section.completed .accordion-completion-indicator {
      display: inline;
    }
    
    /* Intervention container styles */
    .intervention-container {
      margin-bottom: 16px;
      padding: 16px;
      background-color: var(--md-surface-variant, #E1E2EC);
      border-radius: 4px;
    }
    
    .intervention-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .intervention-title {
      font-size: 16px;
      font-weight: 500;
      color: var(--md-on-surface, #1B1B1F);
      margin: 0;
    }
    
    .intervention-status-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .progress-indicator {
      width: 100%;
      height: 8px;
      background-color: var(--md-outline-variant, #C4C6D0);
      border-radius: 4px;
      margin: 8px 0;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background-color: var(--md-primary, #006CFA);
      border-radius: 4px;
    }
    
    /* Form grid layout */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    
    /* Loading indicator */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255, 255, 255, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1100;
    }
    
    .loading-spinner {
      border: 4px solid var(--md-surface-variant, #E1E2EC);
      border-top: 4px solid var(--md-primary, #006CFA);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Form controls */
    .form-group {
      margin-bottom: 16px;
    }
    
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    
    .form-control {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--md-outline, #74777F);
      border-radius: 4px;
      font-size: 16px;
    }
    
    textarea.form-control {
      resize: vertical;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--md-primary, #006CFA);
      box-shadow: 0 0 0 1px var(--md-primary, #006CFA);
    }
    
    /* Checkbox styles */
    .checkbox-group {
      margin-bottom: 8px;
    }
    
    .checkbox-group label {
      display: flex;
      align-items: center;
      font-weight: normal;
    }
    
    .checkbox-group input[type="checkbox"] {
      margin-right: 8px;
    }
    
    /* Required field indicator */
    .required-field::after {
      content: "*";
      color: #BA1A1A;
      margin-left: 4px;
    }
    
    /* Rating scale */
    .rating-scale {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }
    
    .rating-option {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    /* Areas container */
    .areas-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 8px;
      margin-bottom: 16px;
    }
    
    /* Button bar */
    .button-bar {
      display: flex;
      justify-content: flex-end;
      gap: 12px;
      margin-top: 24px;
      padding: 16px;
      border-top: 1px solid var(--md-outline-variant, #C4C6D0);
      position: sticky;
      bottom: 0;
      background-color: var(--md-surface, #FEFBFF);
    }
    
    .btn {
      padding: 10px 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.2s ease;
    }
    
    .btn-primary {
      background-color: var(--md-primary, #006CFA);
      color: white;
    }
    
    .btn-secondary {
      background-color: var(--md-surface-variant, #E1E2EC);
      color: var(--md-on-surface-variant, #44474F);
    }
    
    .btn:hover {
      opacity: 0.9;
    }
    
    /* Invalid form field */
    .form-control.invalid {
      border-color: #BA1A1A;
      box-shadow: 0 0 0 1px #BA1A1A;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      .areas-container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Fixed Header - Integrated from index.html -->
  <header>
    <div class="header-left">
      <div class="logo"><img src="ReVive-IMPACT-Logo.png" alt="ReVive IMPACT Logo" class="logo-image"></div>
      <nav>
        <a href="index.html" class="nav-tab nav-tab-inactive">CONTACT LOG</a>
        <a href="prospects.html" class="nav-tab nav-tab-inactive">PROSPECTS</a>
        <a href="outreach.html" class="nav-tab nav-tab-inactive">OUTREACH</a>
        <a href="cm-ot.html" class="nav-tab nav-tab-active">CM/OT</a>
        <a href="clients.html" class="nav-tab nav-tab-inactive">CLIENTS</a>
        <a href="dashboard.html" class="nav-tab nav-tab-inactive">DASHBOARD</a>
      </nav>
    </div>

    <div class="header-right">
      <div class="search-container">
        <input type="text" class="search-input" id="clientSearchInput" placeholder=" ">
        <span class="search-label">Client Search</span>
        <div class="suggestions-container" id="searchSuggestions"></div>
      </div>
      <div class="user-info">
        <span>Andrea Leflore</span>
        <div class="user-avatar"></div>
      </div>
      <button class="sign-out">Sign Out</button>
    </div>
  </header>

  <!-- Secondary Action Bar -->
  <div class="secondary-action-bar">
    <div class="secondary-action-bar-left">
      <div class="progress-steps-nav">
        <div class="progress-step active" data-section="basicInfo">1. Basic Info</div>
        <div class="progress-step" data-section="occupationalProfile">2. Occupational Profile</div>
        <div class="progress-step" data-section="performanceAreas">3. Performance Areas</div>
        <div class="progress-step" data-section="interventions">4. Interventions</div>
        <div class="progress-step" data-section="adaptationsEquipment">5. Adaptations & Equipment</div>
        <div class="progress-step" data-section="recommendations">6. Recommendations</div>
      </div>
    </div>
    <div class="secondary-action-bar-right">
      <!-- You can add additional action buttons here if needed -->
    </div>
  </div>

  <div style="padding: 24px;">
    <h1 id="clientNameDisplay" style="margin-bottom: 24px; font-size: 24px;">Occupational Therapy Followup</h1>
    
    <form id="otFollowupForm">
      <!-- Basic Information Section -->
      <div class="accordion-section" id="basicInfo">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Basic Information</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content open">
          <div class="form-grid">
            <div class="form-group">
              <label for="followupDate" class="required-field">Date</label>
              <input type="date" id="followupDate" name="followupDate" class="form-control" required>
            </div>
            
            <div class="form-group">
              <label for="occupationalTherapist" class="required-field">Occupational Therapist</label>
              <select id="occupationalTherapist" name="occupationalTherapist" class="form-control" required>
                <option value="">-- Select occupational therapist --</option>
                <option value="Alexandra Perry">Alexandra Perry</option>
                <option value="Cassandra Pagliaruli">Cassandra Pagliaruli</option>
                <option value="Mickey Hahn">Mickey Hahn</option>
                <option value="Diana Sifuentes">Diana Sifuentes</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="sessionType" class="required-field">Session Type</label>
              <select id="sessionType" name="sessionType" class="form-control" required>
                <option value="">-- Select session type --</option>
                <option value="Evaluation">Evaluation</option>
                <option value="Intervention">Intervention</option>
                <option value="Reassessment">Reassessment</option>
                <option value="Discharge Planning">Discharge Planning</option>
                <option value="Home Visit">Home Visit</option>
                <option value="Group Session">Group Session</option>
                <option value="Consultation">Consultation</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="duration" class="required-field">Duration (minutes)</label>
              <input type="number" id="duration" name="duration" class="form-control" min="1" max="240" required>
            </div>
            
            <div class="form-group">
              <label for="location">Location</label>
              <input type="text" id="location" name="location" class="form-control" placeholder="Where session took place...">
            </div>
            
            <div class="form-group">
              <label for="serviceType" class="required-field">Service Type</label>
              <select id="serviceType" name="serviceType" class="form-control" required>
                <option value="">-- Select service type --</option>
                <option value="Direct">Direct</option>
                <option value="Indirect">Indirect (Advocacy)</option>
                <option value="Consultation">Consultation</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Occupational Profile Section -->
      <div class="accordion-section" id="occupationalProfile">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Occupational Profile</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content">
          <div class="form-group">
            <label for="clientStrengths" class="required-field">Client Strengths</label>
            <textarea id="clientStrengths" name="clientStrengths" class="form-control" rows="3" required placeholder="Client's strengths, interests, and values..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="currentChallenges" class="required-field">Current Challenges</label>
            <textarea id="currentChallenges" name="currentChallenges" class="form-control" rows="3" required placeholder="Challenges affecting occupational performance..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="clientGoals" class="required-field">Client-Identified Goals</label>
            <textarea id="clientGoals" name="clientGoals" class="form-control" rows="3" required placeholder="Goals expressed by the client in their own words..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="contextualFactors">Contextual Factors</label>
            <textarea id="contextualFactors" name="contextualFactors" class="form-control" rows="3" placeholder="Environmental, personal, and cultural factors affecting occupational performance..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="occupationalHistory">Occupational History</label>
            <textarea id="occupationalHistory" name="occupationalHistory" class="form-control" rows="3" placeholder="Relevant past experiences, roles, routines, and occupations..."></textarea>
          </div>
        </div>
      </div>
      
      <!-- Performance Areas Section -->
      <div class="accordion-section" id="performanceAreas">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Performance Areas</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content">
          <!-- Activities of Daily Living (ADLs) -->
          <div class="form-group">
            <label>Activities of Daily Living (ADLs)</label>
            <div class="areas-container">
              <div class="form-group">
                <label for="bathing">Bathing/Showering</label>
                <select id="bathing" name="bathing" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="dressing">Dressing</label>
                <select id="dressing" name="dressing" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="toileting">Toileting</label>
                <select id="toileting" name="toileting" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="feeding">Feeding</label>
                <select id="feeding" name="feeding" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="mobility">Functional Mobility</label>
                <select id="mobility" name="mobility" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="personalHygiene">Personal Hygiene</label>
                <select id="personalHygiene" name="personalHygiene" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- Instrumental Activities of Daily Living (IADLs) -->
          <div class="form-group">
            <label>Instrumental Activities of Daily Living (IADLs)</label>
            <div class="areas-container">
              <div class="form-group">
                <label for="mealPrep">Meal Preparation</label>
                <select id="mealPrep" name="mealPrep" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="homeManagement">Home Management</label>
                <select id="homeManagement" name="homeManagement" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="financialManagement">Financial Management</label>
                <select id="financialManagement" name="financialManagement" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="medication">Medication Management</label>
                <select id="medication" name="medication" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="transportation">Community Mobility</label>
                <select id="transportation" name="transportation" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="shopping">Shopping</label>
                <select id="shopping" name="shopping" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Independent">Independent</option>
                  <option value="Modified Independent">Modified Independent</option>
                  <option value="Supervision">Supervision</option>
                  <option value="Minimal Assistance">Minimal Assistance</option>
                  <option value="Moderate Assistance">Moderate Assistance</option>
                  <option value="Maximal Assistance">Maximal Assistance</option>
                  <option value="Dependent">Dependent</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
            </div>
          </div>
          
          <!-- Performance Skills -->
          <div class="form-group">
            <label>Performance Skills</label>
            <div class="areas-container">
              <div class="form-group">
                <label for="motorSkills">Motor Skills</label>
                <select id="motorSkills" name="motorSkills" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Within Normal Limits">Within Normal Limits</option>
                  <option value="Mild Deficit">Mild Deficit</option>
                  <option value="Moderate Deficit">Moderate Deficit</option>
                  <option value="Severe Deficit">Severe Deficit</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="processSkills">Process Skills</label>
                <select id="processSkills" name="processSkills" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Within Normal Limits">Within Normal Limits</option>
                  <option value="Mild Deficit">Mild Deficit</option>
                  <option value="Moderate Deficit">Moderate Deficit</option>
                  <option value="Severe Deficit">Severe Deficit</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="socialSkills">Social Interaction Skills</label>
                <select id="socialSkills" name="socialSkills" class="form-control">
                  <option value="">-- Select level --</option>
                  <option value="Within Normal Limits">Within Normal Limits</option>
                  <option value="Mild Deficit">Mild Deficit</option>
                  <option value="Moderate Deficit">Moderate Deficit</option>
                  <option value="Severe Deficit">Severe Deficit</option>
                  <option value="Not Assessed">Not Assessed</option>
                </select>
              </div>
            </div>
          </div>
          
          <div class="form-group">
            <label for="assessmentNotes">Assessment Notes</label>
            <textarea id="assessmentNotes" name="assessmentNotes" class="form-control" rows="4" placeholder="Additional notes on performance areas..."></textarea>
          </div>
        </div>
      </div>
      
      <!-- Interventions Section -->
      <div class="accordion-section" id="interventions">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Interventions</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content">
          <div class="form-group">
            <label for="interventionApproach" class="required-field">Intervention Approach</label>
            <select id="interventionApproach" name="interventionApproach" class="form-control" required>
              <option value="">-- Select approach --</option>
              <option value="Create/Promote">Create/Promote</option>
              <option value="Establish/Restore">Establish/Restore</option>
              <option value="Maintain">Maintain</option>
              <option value="Modify/Adapt">Modify/Adapt</option>
              <option value="Prevent">Prevent</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="required-field">Intervention Areas (select all that apply)</label>
            <div class="areas-container">
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="ADL Training"> ADL Training</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="IADL Training"> IADL Training</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Health Management"> Health Management</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Management of Living Space"> Management of Living Space</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Functional Mobility"> Functional Mobility</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Community Integration"> Community Integration</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Resource Identification"> Resource Identification</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Cognitive Strategies"> Cognitive Strategies</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Energy Conservation"> Energy Conservation</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Housing Advocacy"> Housing Advocacy</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="interventionAreas" value="Transition Planning"> Transition Planning</label>
              </div>
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" name="interventionAreas" value="Other" id="otherInterventionCheckbox">
                  Other
                </label>
                <input type="text" id="otherIntervention" name="otherIntervention" class="form-control" placeholder="Specify other intervention" style="margin-top: 4px; display: none;">
              </div>
            </div>
          </div>
          
          <!-- Intervention Details -->
          <div class="intervention-container">
            <div class="intervention-header">
              <h3 class="intervention-title">Intervention 1: <span id="intervention1Title">ADL Training</span></h3>
              <div class="intervention-status-container">
                <label for="intervention1Status">Response:</label>
                <select id="intervention1Status" name="intervention1Status" class="form-control" style="width: auto;">
                  <option value="">-- Select --</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good" selected>Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="Not Applicable">Not Applicable</option>
                </select>
              </div>
            </div>
            
            <div class="form-group" style="margin-top: 16px;">
              <label for="intervention1Description">Description</label>
              <textarea id="intervention1Description" name="intervention1Description" class="form-control" rows="2" placeholder="Describe the intervention implemented..."></textarea>
            </div>
            
            <div class="form-group">
              <label for="intervention1Response">Client Response</label>
              <textarea id="intervention1Response" name="intervention1Response" class="form-control" rows="2" placeholder="Describe the client's response to intervention..."></textarea>
            </div>
          </div>
          
          <!-- Add new intervention button -->
          <button type="button" id="addInterventionBtn" class="btn btn-secondary" style="margin-top: 16px;">+ Add Another Intervention</button>
          
          <div class="form-group" style="margin-top: 24px;">
            <label for="interventionSummary" class="required-field">Intervention Summary</label>
            <textarea id="interventionSummary" name="interventionSummary" class="form-control" rows="4" required placeholder="Summarize the interventions provided and overall client response..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="clientEducation">Client/Caregiver Education Provided</label>
            <textarea id="clientEducation" name="clientEducation" class="form-control" rows="3" placeholder="Describe education provided to client and/or caregivers..."></textarea>
          </div>
        </div>
      </div>
      
      <!-- Adaptations & Equipment Section -->
      <div class="accordion-section" id="adaptationsEquipment">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Adaptations & Equipment</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content">
          <div class="form-group">
            <label>Equipment & Adaptations Used/Needed (select all that apply)</label>
            <div class="areas-container">
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Bathing Equipment"> Bathing Equipment</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Dressing Aids"> Dressing Aids</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Toilet/Commode Equipment"> Toilet/Commode Equipment</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Adaptive Feeding Equipment"> Adaptive Feeding Equipment</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Mobility Aids"> Mobility Aids</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Home Modifications"> Home Modifications</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Communication Devices"> Communication Devices</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Medication Management Tools"> Medication Management Tools</label>
              </div>
              <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="Environmental Adaptations"> Environmental Adaptations</label>
              </div>
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" name="equipment" value="Other" id="otherEquipmentCheckbox">
                  Other
                </label>
                <input type="text" id="otherEquipment" name="otherEquipment" class="form-control" placeholder="Specify other equipment or adaptations" style="margin-top: 4px; display: none;">
              </div>
            </div>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="currentEquipment">Current Equipment/Adaptations</label>
              <textarea id="currentEquipment" name="currentEquipment" class="form-control" rows="3" placeholder="Describe equipment/adaptations currently being used..."></textarea>
            </div>
            
            <div class="form-group">
              <label for="recommendedEquipment">Recommended Equipment/Adaptations</label>
              <textarea id="recommendedEquipment" name="recommendedEquipment" class="form-control" rows="3" placeholder="Describe recommended equipment/adaptations..."></textarea>
            </div>
          </div>
          
          <div class="form-group">
            <label for="equipmentTraining">Equipment/Adaptation Training Provided</label>
            <textarea id="equipmentTraining" name="equipmentTraining" class="form-control" rows="3" placeholder="Describe training provided on equipment/adaptations use..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="environmentAssessment">Environment Assessment</label>
            <textarea id="environmentAssessment" name="environmentAssessment" class="form-control" rows="3" placeholder="Note any environmental factors impacting occupational performance..."></textarea>
          </div>
        </div>
      </div>
      
      <!-- Recommendations Section -->
      <div class="accordion-section" id="recommendations">
        <div class="accordion-header">
          <div>
            <span class="accordion-completion-indicator">✓</span>
            <h3 class="accordion-title">Recommendations</h3>
          </div>
          <span class="accordion-indicator">▼</span>
        </div>
        <div class="accordion-content">
          <div class="form-group">
            <label for="otPlan" class="required-field">OT Plan</label>
            <textarea id="otPlan" name="otPlan" class="form-control" rows="4" required placeholder="Outline the plan for future OT services..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="shortTermGoals">Short-term Goals</label>
            <textarea id="shortTermGoals" name="shortTermGoals" class="form-control" rows="3" placeholder="List short-term OT goals for client..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="longTermGoals">Long-term Goals</label>
            <textarea id="longTermGoals" name="longTermGoals" class="form-control" rows="3" placeholder="List long-term OT goals for client..."></textarea>
          </div>
          
          <div class="form-grid">
            <div class="form-group">
              <label for="referrals">Referrals</label>
              <textarea id="referrals" name="referrals" class="form-control" rows="3" placeholder="Note any referrals made to other services..."></textarea>
            </div>
            
            <div class="form-group">
              <label for="followUpPlans">Follow-up Plans</label>
              <textarea id="followUpPlans" name="followUpPlans" class="form-control" rows="3" placeholder="Describe plans for follow-up..."></textarea>
            </div>
          </div>
          
          <div class="form-group">
            <label for="dapNote">DAP Note (Documentation, Assessment, Plan)</label>
            <textarea id="dapNote" name="dapNote" class="form-control" rows="6" placeholder="D: Factual information about what occurred during the session
A: Analysis/interpretation of the information
P: Plan for addressing identified issues"></textarea>
          </div>
          
          <div class="form-group">
            <label for="additionalNotes">Additional Notes</label>
            <textarea id="additionalNotes" name="additionalNotes" class="form-control" rows="3" placeholder="Include any additional information or notes not captured elsewhere..."></textarea>
          </div>
        </div>
      </div>
    </form>

    <!-- Form navigation buttons -->
    <div class="button-bar">
      <button type="button" class="btn btn-secondary" id="prevStepBtn">Previous</button>
      <button type="button" class="btn btn-secondary" id="saveAsDraftBtn">Save as Draft</button>
      <button type="button" class="btn btn-primary" id="nextStepBtn">Next</button>
      <button type="button" class="btn btn-primary" id="submitFormBtn" style="display: none;">Submit</button>
    </div>
    
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none;">
      <div class="loading-spinner"></div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // DOM elements
      const clientNameDisplay = document.getElementById('clientNameDisplay');
      const accordionSections = document.querySelectorAll('.accordion-section');
      const progressSteps = document.querySelectorAll('.progress-step');
      const prevStepBtn = document.getElementById('prevStepBtn');
      const nextStepBtn = document.getElementById('nextStepBtn');
      const submitFormBtn = document.getElementById('submitFormBtn');
      const saveAsDraftBtn = document.getElementById('saveAsDraftBtn');
      
      // Set current client name from URL or parent window
      function setClientName() {
        // Try to get from URL parameter
        const urlParams = new URLSearchParams(window.location.search);
        const clientParam = urlParams.get('client');
        
        if (clientParam) {
          clientNameDisplay.textContent = `Occupational Therapy Followup: ${clientParam}`;
        } else if (window.parent && window.parent.currentClientName) {
          // Try to get from parent window
          clientNameDisplay.textContent = `Occupational Therapy Followup: ${window.parent.currentClientName}`;
        }
      }
      
      // Initialize form with default values
      function initializeForm() {
        // Set today's date
        const today = new Date();
        const formattedDate = today.toISOString().substring(0, 10);
        document.getElementById('followupDate').value = formattedDate;
        
        // Set default duration
        document.getElementById('duration').value = 60;
        
        // Initialize accordion sections
        initializeAccordions();
        
        // Initialize progress tracking
        updateProgressIndicator();
        
        // Initialize form navigation
        initializeFormNavigation();
        
        // Initialize "Other" field toggles
        initializeOtherFields();
        
        // Add new intervention button functionality
        initializeAddInterventionButton();
      }
      
      // Initialize accordion functionality
      function initializeAccordions() {
        accordionSections.forEach(section => {
          const header = section.querySelector('.accordion-header');
          const content = section.querySelector('.accordion-content');
          const indicator = section.querySelector('.accordion-indicator');
          
          header.addEventListener('click', function() {
            // Close all other sections first
            accordionSections.forEach(otherSection => {
              if (otherSection !== section) {
                otherSection.querySelector('.accordion-content').classList.remove('open');
                otherSection.querySelector('.accordion-indicator').classList.remove('open');
              }
            });
            
            // Toggle current section
            content.classList.toggle('open');
            indicator.classList.toggle('open');
            
            // Update progress tracking
            updateProgressIndicator();
          });
        });
        
        // By default, only show the first section
        accordionSections.forEach((section, index) => {
          const content = section.querySelector('.accordion-content');
          const indicator = section.querySelector('.accordion-indicator');
          
          if (index === 0) {
            content.classList.add('open');
            indicator.classList.add('open');
          } else {
            content.classList.remove('open');
            indicator.classList.remove('open');
          }
        });
      }
      
      // Initialize progress steps navigation
      function initializeFormNavigation() {
        // Click handlers for progress steps
        progressSteps.forEach(step => {
          step.addEventListener('click', function() {
            const sectionId = this.getAttribute('data-section');
            navigateToSection(sectionId);
          });
        });
        
        // Previous button
        prevStepBtn.addEventListener('click', function() {
          const currentSection = getCurrentSection();
          const currentIndex = getIndexOfSection(currentSection);
          
          if (currentIndex > 0) {
            const prevSection = accordionSections[currentIndex - 1].id;
            navigateToSection(prevSection);
          }
        });
        
        // Next button
        nextStepBtn.addEventListener('click', function() {
          const currentSection = getCurrentSection();
          const currentIndex = getIndexOfSection(currentSection);
          
          if (validateCurrentSection(currentSection)) {
            // Mark current section as completed
            accordionSections[currentIndex].classList.add('completed');
            updateProgressIndicator();
            
            if (currentIndex < accordionSections.length - 1) {
              const nextSection = accordionSections[currentIndex + 1].id;
              navigateToSection(nextSection);
            } else {
              // We're on the last section, show submit button
              nextStepBtn.style.display = 'none';
              submitFormBtn.style.display = 'inline-block';
            }
          } else {
            alert('Please complete all required fields in this section before proceeding.');
          }
        });
        
        // Submit button
        submitFormBtn.addEventListener('click', function() {
          const currentSection = getCurrentSection();
          
          if (validateCurrentSection(currentSection)) {
            submitForm();
          } else {
            alert('Please complete all required fields in this section before submitting.');
          }
        });
      }
      
      // Navigate to a specific section
      function navigateToSection(sectionId) {
        // Close all sections
        accordionSections.forEach(section => {
          section.querySelector('.accordion-content').classList.remove('open');
          section.querySelector('.accordion-indicator').classList.remove('open');
        });
        
        // Open the target section
        const targetSection = document.getElementById(sectionId);
        targetSection.querySelector('.accordion-content').classList.add('open');
        targetSection.querySelector('.accordion-indicator').classList.add('open');
        
        // Update active progress step
        progressSteps.forEach(step => {
          step.classList.remove('active');
          if (step.getAttribute('data-section') === sectionId) {
            step.classList.add('active');
          }
        });
        
        // Update buttons
        const currentIndex = getIndexOfSection(sectionId);
        prevStepBtn.disabled = currentIndex === 0;
        
        if (currentIndex === accordionSections.length - 1) {
          nextStepBtn.style.display = 'none';
          submitFormBtn.style.display = 'inline-block';
        } else {
          nextStepBtn.style.display = 'inline-block';
          submitFormBtn.style.display = 'none';
        }
        
        // Scroll to the top of the section
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
      
      // Get the currently visible section
      function getCurrentSection() {
        for (let i = 0; i < accordionSections.length; i++) {
          if (accordionSections[i].querySelector('.accordion-content').classList.contains('open')) {
            return accordionSections[i].id;
          }
        }
        return null;
      }
      
      // Get the index of a section by ID
      function getIndexOfSection(sectionId) {
        for (let i = 0; i < accordionSections.length; i++) {
          if (accordionSections[i].id === sectionId) {
            return i;
          }
        }
        return -1;
      }
      
      // Update progress indicators
      function updateProgressIndicator() {
        // Update progress steps
        progressSteps.forEach((step, index) => {
          const sectionId = step.getAttribute('data-section');
          const section = document.getElementById(sectionId);
          
          if (section.classList.contains('completed')) {
            step.classList.add('completed');
          } else {
            step.classList.remove('completed');
          }
        });
      }
      
      // Validate the current section before proceeding
      function validateCurrentSection(sectionId) {
        const section = document.getElementById(sectionId);
        const requiredFields = section.querySelectorAll('[required]');
        
        let isValid = true;
        
        requiredFields.forEach(field => {
          // For checkboxes, we need to check if at least one is checked
          if (field.type === 'checkbox' && field.name.endsWith('[]')) {
            const checkboxGroup = document.querySelectorAll(`input[name="${field.name}"]`);
            let anyChecked = false;
            checkboxGroup.forEach(checkbox => {
              if (checkbox.checked) {
                anyChecked = true;
              }
            });
            
            if (!anyChecked) {
              isValid = false;
              field.closest('.form-group').classList.add('invalid');
            } else {
              field.closest('.form-group').classList.remove('invalid');
            }
          } else if (!field.value) {
            isValid = false;
            field.classList.add('invalid');
          } else {
            field.classList.remove('invalid');
          }
        });
        
        return isValid;
      }
      
      // Initialize "Other" field toggles
      function initializeOtherFields() {
        // Intervention "Other" toggle
        const otherInterventionCheckbox = document.getElementById('otherInterventionCheckbox');
        const otherInterventionInput = document.getElementById('otherIntervention');
        
        otherInterventionCheckbox.addEventListener('change', function() {
          otherInterventionInput.style.display = this.checked ? 'block' : 'none';
        });
        
        // Equipment "Other" toggle
        const otherEquipmentCheckbox = document.getElementById('otherEquipmentCheckbox');
        const otherEquipmentInput = document.getElementById('otherEquipment');
        
        otherEquipmentCheckbox.addEventListener('change', function() {
          otherEquipmentInput.style.display = this.checked ? 'block' : 'none';
        });
      }
      
      // Initialize add intervention button
      function initializeAddInterventionButton() {
        const addInterventionBtn = document.getElementById('addInterventionBtn');
        let interventionCount = 1; // Start with 1 intervention
        
        addInterventionBtn.addEventListener('click', function() {
          interventionCount++;
          
          // Create new intervention container
          const newIntervention = document.createElement('div');
          newIntervention.className = 'intervention-container';
          newIntervention.innerHTML = `
            <div class="intervention-header">
              <div style="display: flex; align-items: center; gap: 12px; width: 100%;">
                <h3 class="intervention-title">Intervention ${interventionCount}:</h3>
                <input type="text" id="intervention${interventionCount}Title" name="intervention${interventionCount}Title" class="form-control" placeholder="Enter intervention title..." style="flex: 1;">
                <button type="button" class="remove-intervention" style="background: none; border: none; color: var(--md-error, #BA1A1A); cursor: pointer; font-size: 18px; padding: 4px 8px;">&times;</button>
              </div>
              <div class="intervention-status-container">
                <label for="intervention${interventionCount}Status">Response:</label>
                <select id="intervention${interventionCount}Status" name="intervention${interventionCount}Status" class="form-control" style="width: auto;">
                  <option value="">-- Select --</option>
                  <option value="Excellent">Excellent</option>
                  <option value="Good" selected>Good</option>
                  <option value="Fair">Fair</option>
                  <option value="Poor">Poor</option>
                  <option value="Not Applicable">Not Applicable</option>
                </select>
              </div>
            </div>
            
            <div class="form-group" style="margin-top: 16px;">
              <label for="intervention${interventionCount}Description">Description</label>
              <textarea id="intervention${interventionCount}Description" name="intervention${interventionCount}Description" class="form-control" rows="2" placeholder="Describe the intervention implemented..."></textarea>
            </div>
            
            <div class="form-group">
              <label for="intervention${interventionCount}Response">Client Response</label>
              <textarea id="intervention${interventionCount}Response" name="intervention${interventionCount}Response" class="form-control" rows="2" placeholder="Describe the client's response to intervention..."></textarea>
            </div>
          `;
          
          // Insert new intervention before the Add Intervention button
          addInterventionBtn.parentNode.insertBefore(newIntervention, addInterventionBtn);
          
          // Add event listener to remove button
          const removeBtn = newIntervention.querySelector('.remove-intervention');
          removeBtn.addEventListener('click', function() {
            newIntervention.remove();
          });
        });
      }
      
      // Submit the form
      function submitForm() {
        // Show loading overlay
        document.getElementById('loadingOverlay').style.display = 'flex';
        
        // Collect form data
        const formData = new FormData(document.getElementById('otFollowupForm'));
        
        // In a real implementation, this would submit to a server
        // For demo purposes, we'll simulate a submission delay
        setTimeout(function() {
          // Hide loading overlay
          document.getElementById('loadingOverlay').style.display = 'none';
          
          // Show success message
          alert('Occupational Therapy followup record submitted successfully!');
          
          // Notify the parent window that submission is complete
          if (window.parent && typeof window.parent.onFollowupSubmitted === 'function') {
            try {
              window.parent.onFollowupSubmitted();
            } catch (e) {
              console.error('Error notifying parent window:', e);
            }
          }
        }, 1500);
      }
      
      // Save as draft
      saveAsDraftBtn.addEventListener('click', function() {
        alert('Followup saved as draft. You can access it later from your drafts folder.');
      });
      
      // Initialize the form
      setClientName();
      initializeForm();
    });
  </script>
</body>
</html>
